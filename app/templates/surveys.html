{% extends "layout.html" %}

{% block title %}설문조사 목록{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="flex justify-between items-center">
        <h1 class="text-2xl font-bold text-gray-800">설문조사 목록</h1>
        <a href="/surveys/new" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
            <i class="fas fa-plus mr-2"></i>새 설문조사
        </a>
    </div>

    <!-- Surveys Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for survey in surveys %}
        <div class="card p-6 hover:shadow-lg transition-shadow">
            <h3 class="text-xl font-semibold text-gray-800 mb-2">{{ survey.title }}</h3>
            <p class="text-gray-600 mb-4">생성일: {{ survey.created_at.strftime('%Y-%m-%d') }}</p>
            <div class="flex justify-between items-center">
                <span class="text-sm text-gray-500">
                    <i class="fas fa-users mr-1"></i>
                    {{ survey.questions|length }}개의 질문
                </span>
                <div class="space-x-2">
                    <a href="/surveys/{{ survey.id }}/take" class="text-green-500 hover:text-green-600">
                        <i class="fas fa-pencil-alt mr-1"></i>설문 참여하기
                    </a>
                    <a href="/surveys/{{ survey.id }}" class="text-blue-500 hover:text-blue-600">
                        <i class="fas fa-eye mr-1"></i>자세히 보기
                    </a>
                    <a href="/admin/surveys/{{ survey.id }}/responses" class="text-blue-600 hover:text-blue-900">응답 보기</a>
                    <a href="/admin/surveys/{{ survey.id }}/edit" class="text-blue-600 hover:text-blue-900">수정</a>
                    <button onclick="deleteSurvey({{ survey.id }})" class="text-red-600 hover:text-red-900">삭제</button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
function deleteSurvey(surveyId) {
    if (!confirm('정말로 이 설문조사를 삭제하시겠습니까?')) {
        return;
    }

    fetch(`/surveys/${surveyId}`, {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json',
        }
    })
    .then(response => response.json())
    .then(data => {
        alert(data.message);
        window.location.reload();
    })
    .catch(error => {
        console.error('Error:', error);
        alert('설문조사 삭제에 실패했습니다.');
    });
}
</script>
{% endblock %} 